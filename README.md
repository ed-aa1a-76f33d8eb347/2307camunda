## Задание
1. Две сущности, `заказ` и `постинг`(отправление, посылка). Заказ может содержать несколько постингов(как минимум, один), создаются одновременно (разбитие всего заказа на отдельные постинги, сплитование, происходит снаружи)
2. Статусная модель Заказа: `Создан, Собирается на складе, В доставке, Ждет в ПВЗ`. Финальные статусы: `Получен, Отменен`
3. Статусная модель Постинга: `Ожидает оплаты, Собирается на складе, В доставке, Ждет в ПВЗ`. Финальные статусы: `Получен, Отменен`
4. Движение по статусам: натуральное, слева направо. Переход в статус `Отменен` допускается из любого статуса
   1. Постинг меняет статус по внешним событиям
   2. Заказ переходит на следующий статус, как только любой из постингов его состава достигает следующего шага
   3. Финальный статус заказа определяется следующим образом, когда все его постинги достигли финального статуса:
      1. `Получен`: среди постингов есть хоть в статусе `Получен`
      2. `Отменен`: все его постиги в статусе `Отменен`
5. Статусы `Ожидает оплаты` и `Ждет в ПВЗ` у постинга - имеют время жизни. Если за заданный промежуток времени движения по статусам не было, то постинг отменяется
   

Итого: получается два процесса с небольшим одностороним взаимодействием между ними


~~Одним из финальным шагом по оредру, в случае, если он в статусе`Получен` могу получить курс валют через https://www.cbr-xml-daily.ru/latest.js и пересчитать сумму в какую-нибудь валюту? Финальным - потому что в процессе какие-то постинги могут отмениться.~~

Немного исправил этот пункт: пересчет валюты в нужную происходит первым же шагом после создания, а сумма заказа считается уже в конце

## Настройки
 * `currency.defaultCode` - код валюты, в которую будет все конвертироваться
 * `currency.mock` - использовать ли реальный(`false`) сервис по получению курса валюты или заглушку(`true`). Данные для щаглушки берутся из файла `currencies.xml`  
 * `timeout.awaitingPayment` - время ожидания постинга в статусе "Ожидает оплаты"
 * `timeout.awaitingReceived` - время ожидания постинга в статусе "Ожидает в ПВЗ"

## API
Swagger http://localhost:8080/docs

При запуске [excamad](https://github.com/KotskinKotskin/camunda-excamad) через 
`docker run -d -p 8081:8080 kotovdenis/excamad:latest` необходимо прописать url camunda-engine `http://localhost:8080/engine-rest/` 

* `POST /order/createRandom` - создает заказ с постингами с произвольными значениями стоимостей
* `POST /order/create` - позволяет создать заказ с вручную созданными значениями
* `POST /notify/posting/{postingId}/nextStatus` - имитирует месседж о переходе постинга на следующий шаг по happyPath
* `POST /notify/posting/{postingId}/cancel` - имитирует сообщение об отмене постинга в произвольный момент
* `POST /notify/order/{orderId}/cancel` - имитирует сообщение об отмене заказа - что влечет за собой отмену всех его постингов
* еще есть несколько ручек - они очевидные, в пояснениях не нуждаются
* некоторые ручки апи закомментированы, но не убраны. Чтобы не захламлять апи, но потенциальная польза от них есть

## Тесты
Есть два теста: `DemoCamundaApplicationIT` и `DemoCamundaApplicationTest